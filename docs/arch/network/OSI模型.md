# OSI七层模型

## 基础

发送方从最高层开始，从上到下按顺序传输数据，每一层接收到由上层处理的数据时，添加该层的首部并可能会对数据进行处理（如表示层）。而接收端则将顺序反过来，从首层开始，将数据的内容与该层对应的首部拆开，传给上一层。

## 应用层

![应用层协议](/img/arch/network/应用层.jpg)

应用层作用是为应用程序提供服务并规定应用程序中通讯相关的细节，也就是为应用提供服务。

常见的协议有HTTP，FTP，TELNET、SMTP等。

接触最多的是HTTP协议，当浏览器发起请求时，通过HTTP协议获得数据以供浏览器使用，这就是应用层的用途。而请求时发生错误，对错误进行处理，也是应用层需要负责的。

### HTTP协议

HTTP消息中还有一些用来表示附加信息的头字段。客户端向Web服务器发送数据时，会先发送头字段，然后再发送数据。

收到请求消息之后，Web服务器会对其中的内容进行解析，通过URI和方法来判断“对什么”“进行怎样的操作”，并根据这些要求来完成自己的工作，然后将结果存放在响应消息中。在响应消息的开头有一个状态码，它用来表示操作的执行结果是成功还是发生了错误。状态码后面就是头字段和网页数据。

CGI程序：对Web服务器程序调用其他程序的规则所做的定义就是CGI，而按照CGI规范来工作的程序就称为CGI程序。

| 状态码  | 含义           |
| ---- | ------------ |
| 1xx  | 告知请求的处理进度和情况 |
| 2xx  | 成功           |
| 3xx  | 表示需要进一步操作    |
| 4xx  | 客户端错误        |
| 5xx  | 服务器错误        |

主要操作方法：

* GET：获取 URI 指定的信息。如果 URI 指定的是文件，则返回文件的内容；如果 URI 指定的是 CGI 程序，则返回该程序的输出数据。操作过程数据不加密，且数据大小有限制。
* POST：从客户端向服务器发送数据。一般用于发送表单中填写的数据，传输过程简单加密且大小无限制。
* PUT：替换 URI 指定的服务器上的文件。如果 URI 指定的文件不存在，则创建该文件。
* DELETE：删除 URI 指定的服务器上的文件。
* HEAD：与 GET 类似，不过只返回 HTTP 的消息头，而并不返回数据的内容。用于获取文件最后更新时间等属性信息。
* OPTIONS：用于通知或查询通信选项
* TRACE：将服务器收到的请求行和头部(header)直接返回给客户端。用于在使用代理的环境中检查改写请求的情况。
* CONNECT：使用代理传输加密消息时使用的方法。

### 问题

**1. 简述get和post的区别？**

GET一般用于获取/查询资源信息，信息显示在URL中，而POST一般用于更新资源信息。

http://blog.csdn.net/KevinwuwenboA/article/details/53041598

**2. 解释下面返回的内容。**

```shell
$ curl -X HEAD -I https://zuolan.me
HTTP/1.1 200 Connection established
Proxy-agent: CCProxy

HTTP/1.1 200 OK
Server: nginx
Date: Sat, 09 Sep 2017 12:18:18 GMT
Content-Type: text/html;charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: grav-site-188af56=ev2aalauk3t9qpau6qjlgqvc2b; expires=Sat, 09-Sep-2017 12:48:18 GMT; Max-Age=1800; path=/; domain=zuolan.me
Pragma: no-cache
Set-Cookie: grav-site-188af56=ev2aalauk3t9qpau6qjlgqvc2b; expires=Sat, 09-Sep-2017 12:48:18 GMT; Max-Age=1800; path=/; domain=zuolan.me; HttpOnly
Cache-Control: max-age=604800
Expires: Sat, 16 Sep 2017 12:18:18 GMT
Strict-Transport-Security: max-age=63072000; includeSubDomains; preload
X-Frame-Options: DENY
X-Content-Type-Options: nosniff
Access-Control-Allow-Credentials: true
Access-Control-Allow-Methods: GET, POST, OPTIONS
```

## 表示层

![表示层](/img/arch/network/表示层.jpg)

表示层的作用是将应用处理的信息转换为适合网络传输的格式，或者将来自下一层的数据转换为上层能处理的格式。它主要负责数据格式的转换，将设备固有的数据格式转换为网络标准格式。

常见的协议有ASCII、SSL/TLS等。

浏览器请求回一堆数据，是解析成文本还是图片，就由表示层决定。数据的压缩、加密、打包等功能也都在这层完成。

## 会话层

![会话层](/img/arch/network/会话层.jpg)

会话层作用是负责建立和断开通信连接（数据流动的逻辑通路），以及数据的分割等数据传输相关的管理。

常见的协议有ADSP、RPC等。

## 传输层

![传输层](/img/arch/network/传输层.jpg)

传输层起着可靠传输的作用。只在通信双方节点进行处理，而不需在路由器上处理。

此层有两个具有代表性的协议： TCP 与 UDP。

TCP协议提供可靠的通信传输，简单说就是确认目标能通信的情况下才会传输数据（需要三次握手），传输过程如果丢了数据，也会重发。

UDP协议则不然，不会确认目标能否通信，只会根据协议发到对方地址的端口。

## 网络层

![网络层](/img/arch/network/网络层.jpg)

网络层负责将数据传输到目标地址。目标地址可以使多个网络通过路由器连接而成的某一个地址。因此这一层主要负责寻址和路由选择。

主要由IP、ICMP两个协议组成。

网络层将数据从发送端的主机发送到接收端的主机，两台主机间可能会存在很多数据链路，但网络层就是负责找出一条相对顺畅的通路将数据传递过去。

## 数据链路层

![数据链路层](/img/arch/network/数据链路层.jpg)

该层负责物理层面上互连的节点之间的通信传输。例如与1个以太网相连的两个节点间的通讯。数据链路层会将0、1序列划分为具有意义的数据帧传送给对端（数据帧的生成与接收）。

常见的协议有HDLC、PPP、SLIP等。

举个例子，暂且把需要传输的数据看作为不同来源的水，如果直接倒入池子中时，是无法重新分辨出不同来源的水的。但如果将不同来源的灌入瓶子中并打上记号，那就能区分出不同来源的水。这也就是为什么要划分为具有意义的数据帧传送给对端。同时要注意的是，数据链路层只负责将数据运送给物理相连的两端，并不负责直接发送到最终地址（类似快递公司的飞机从一座城市运到另一座城市）。

## 物理层

![物理层](/img/arch/network/物理层.jpg)

物理层负责0、1比特流（0、1序列）与电压高低、光的闪灭之间的互换。

典型的协议有RS 232C、RS 449/422/423、V.24/X.21、X.21bis等。

我也不知道是啥，反正过程就是将数据的0、1转换成电信号或者光信号。通过光纤、双绞线甚至是无限电波等介质传输到指定的地址。

而传输过程中的集线器、中继器、调制解调器等，也属于物理层的传输介质。

物理层是OSI七层模型的物理基础，没有它就谈不上数据传输了。